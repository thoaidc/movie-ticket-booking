# ğŸ“Š Há»‡ thá»‘ng Ä‘áº·t vÃ© xem phim - PhÃ¢n TÃ­ch vÃ  Thiáº¿t Káº¿

---

## ThÃ nh viÃªn

NhÃ³m 21:

| Há» vÃ  tÃªn        | MÃ£ sinh viÃªn |
|------------------|--------------|
| Nguyá»…n Tháº¿ DÅ©ng  | B21DCCN275   |
| Nguyá»…n Äáº¯c Phong | B21DCCN587   |
| ÄÃ m CÃ´ng Thoáº¡i   | B21DCCN695   |


---


## 1. ğŸ¯  MÃ´ Táº£ BÃ i ToÃ¡n vÃ  MÃ´ hÃ¬nh nghiá»‡p vá»¥

> **BÃ i toÃ¡n:** Há»‡ thá»‘ng Ä‘áº·t phÃ²ng khÃ¡ch sáº¡n trá»±c tuyáº¿n

_MÃ´ táº£ nghiá»‡p vá»¥_

Há»‡ thá»‘ng Ä‘áº·t vÃ© xem phim cho phÃ©p khÃ¡ch hÃ ng chá»n phim, suáº¥t chiáº¿u, gháº¿ ngá»“i vÃ  tiáº¿n hÃ nh Ä‘áº·t vÃ© trá»±c tuyáº¿n.
Sau khi khÃ¡ch hÃ ng chá»n phim, há»‡ thá»‘ng sáº½ kiá»ƒm tra tÃ¬nh tráº¡ng chá»— ngá»“i, xÃ¡c minh thÃ´ng tin vÃ©, vÃ  xá»­ lÃ½ thanh toÃ¡n. 
Náº¿u Ä‘áº·t vÃ© thÃ nh cÃ´ng, há»‡ thá»‘ng sáº½ gá»­i thÃ´ng bÃ¡o xÃ¡c nháº­n vÃ© Ä‘Ã£ Ä‘áº·t Ä‘áº¿n email cá»§a khÃ¡ch hÃ ng.

---

## 2. ğŸ§© XÃ¡c Ä‘á»‹nh cÃ¡c Microservice

_XÃ¡c Ä‘á»‹nh cÃ¡c thá»±c thá»ƒ_
**Äá»‘i tÆ°á»£ng sá»­ dá»¥ng**
- KhÃ¡ch hÃ ng cÃ¡ nhÃ¢n

**Má»¥c tiÃªu chÃ­nh**
- Cho phÃ©p khÃ¡ch hÃ ng tÃ¬m kiáº¿m vÃ  Ä‘áº·t vÃ© trá»±c tuyáº¿n
- Tá»± Ä‘á»™ng hÃ³a quy trÃ¬nh Ä‘áº·t vÃ© vÃ  thÃ´ng bÃ¡o

**Dá»¯ liá»‡u xá»­ lÃ½**
- ThÃ´ng tin ngÆ°á»i dÃ¹ng
- ThÃ´ng tin phim, vÃ©, chá»— ngá»“i vÃ  tráº¡ng thÃ¡i chá»— ngá»“i
- ThÃ´ng tin thanh toÃ¡n

_Thiáº¿t káº¿ thá»±c thá»ƒ_

![Entity Relationship Diagram](../docs/assets/entities.jpg)


_Thiáº¿t káº¿ nhá»¯ng dá»‹ch vá»¥_
Ta sáº½ Ä‘i qua phÃ¢n tÃ­ch quy trÃ¬nh nghiá»‡p vá»¥ cá»§a dá»± Ã¡n nÃ y vÃ  lá»c nhá»¯ng logic nghiá»‡p vá»¥ mÃ  sáº½ cÃ³ thá»ƒ cho vÃ o nhá»¯ng thá»±c thá»ƒ khÃ¡c nhau Ä‘á»ƒ ta cÃ³ thá»ƒ Ä‘Æ°a ra nhá»¯ng Ä‘á»‘i tÆ°á»£ng dá»‹ch vá»¥ kháº£ quan cá»§a há»‡ thá»‘ng.

**Äáº·t vÃ© xem phim**

1.Báº¯t Ä‘áº§u quy trÃ¬nh Ä‘áº·t vÃ©: KhÃ¡ch hÃ ng truy cáº­p há»‡ thá»‘ng vÃ  báº¯t Ä‘áº§u quy trÃ¬nh Ä‘áº·t vÃ© xem phim.

2.Chá»n phim vÃ  suáº¥t chiáº¿u: KhÃ¡ch hÃ ng chá»n phim muá»‘n xem, cÃ¹ng vá»›i suáº¥t chiáº¿u vÃ  ráº¡p phim cá»¥ thá»ƒ.

3.Chá»n gháº¿ ngá»“i: KhÃ¡ch hÃ ng chá»n gháº¿ ngá»“i tá»« danh sÃ¡ch cÃ¡c gháº¿ cÃ²n trá»‘ng.

4.XÃ¡c minh gháº¿ ngá»“i cÃ²n trá»‘ng: Há»‡ thá»‘ng kiá»ƒm tra tÃ¬nh tráº¡ng gháº¿ ngá»“i Ä‘Ã£ Ä‘Æ°á»£c chá»n xem cÃ²n trá»‘ng hay Ä‘Ã£ cÃ³ ngÆ°á»i Ä‘áº·t.

5.Náº¿u khÃ´ng cÃ²n gháº¿ ngá»“i, káº¿t thÃºc quy trÃ¬nh: Náº¿u gháº¿ Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t bá»Ÿi ngÆ°á»i khÃ¡c, há»‡ thá»‘ng thÃ´ng bÃ¡o vÃ  dá»«ng quy trÃ¬nh.

6.Nháº­p thÃ´ng tin khÃ¡ch hÃ ng: KhÃ¡ch hÃ ng cung cáº¥p cÃ¡c thÃ´ng tin cÃ¡ nhÃ¢n nhÆ° há» tÃªn, sá»‘ Ä‘iá»‡n thoáº¡i vÃ  email.

7.XÃ¡c minh thÃ´ng tin vÃ©: Há»‡ thá»‘ng xÃ¡c minh thÃ´ng tin vÃ© xem phim vÃ  cÃ¡c chi tiáº¿t liÃªn quan.

8.Nháº­p vÃ  thá»±c hiá»‡n thanh toÃ¡n: KhÃ¡ch hÃ ng tiáº¿n hÃ nh thanh toÃ¡n trá»±c tuyáº¿n thÃ´ng qua cÃ¡c cá»•ng thanh toÃ¡n.

9.Náº¿u thanh toÃ¡n thÃ nh cÃ´ng, gá»­i thÃ´ng bÃ¡o xÃ¡c nháº­n: Náº¿u giao dá»‹ch thÃ nh cÃ´ng, há»‡ thá»‘ng gá»­i thÃ´ng bÃ¡o xÃ¡c nháº­n vÃ© Ä‘Ã£ Ä‘áº·t Ä‘áº¿n email cá»§a khÃ¡ch hÃ ng.

10.Cáº­p nháº­t tÃ¬nh tráº¡ng gháº¿ ngá»“i: Há»‡ thá»‘ng cáº­p nháº­t tÃ¬nh tráº¡ng gháº¿ Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u.

11.LÆ°u thÃ´ng tin vÃ© vÃ  khÃ¡ch hÃ ng vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u: Há»‡ thá»‘ng lÆ°u thÃ´ng tin vÃ© Ä‘Ã£ Ä‘áº·t vÃ  thÃ´ng tin khÃ¡ch hÃ ng vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»ƒ quáº£n lÃ½



| TÃªn dá»‹ch vá»¥                   | TrÃ¡ch nhiá»‡m                        | CÃ´ng nghá»‡   | CSDL    | Giao thá»©c |
|-------------------------------|------------------------------------|-------------|---------|-----------|
| **customer-service**          | Quáº£n lÃ½ ngÆ°á»i dÃ¹ng                 | RESTFUL API | MySQL   | REST      |
| **movie-service**             | Quáº£n lÃ½ phim, suáº¥t chiáº¿u, chá»— ngá»“i | RESTFUL API | MySQL   | REST      |
| **ticket-booking-service**    | Xá»­ lÃ½ Ä‘áº·t vÃ©                       | RESTFUL API | MySQL   | REST      |
| **seat-availability-service** | Kiá»ƒm tra tÃ¬nh tráº¡ng gháº¿            | RESTFUL API | MySQL   | REST      |
| **notification-service**      | Gá»­i email thÃ´ng bÃ¡o                | RESTFUL API | MySQL   | REST      |
| **payment-service**           | Xá»­ lÃ½ thanh toÃ¡n                   | RESTFUL API | MySQL   | REST      |


## 3. ğŸ”„ Giao tiáº¿p giá»¯a cÃ¡c dá»‹ch vá»¥

### **CÆ¡ cháº¿ chÃ­nh**
![flow](../docs/assets/flow.jpg
)


### **Chi tiáº¿t cÃ¡c kÃªnh káº¿t ná»‘i**
| **Káº¿t ná»‘i**                 | **Protocol** | **Má»¥c Ä‘Ã­ch**                  |  
|-----------------------------|--------------|-------------------------------|  
| Client â†” API Gateway        | HTTP/REST    | Táº¥t cáº£ request tá»« client      |  
| API Gateway â†” Core Services | HTTP/REST    | Äá»‹nh tuyáº¿n request            |  
| Booking â†” Seat Availability | HTTP/REST    | Kiá»ƒm tra gháº¿ trá»‘ng            |  
| Booking â†” Notification      | RabbitMQ     | Gá»­i thÃ´ng bÃ¡o khÃ´ng Ä‘á»“ng bá»™   |  
| Booking â†” Booking History   | HTTP/REST    | Ghi log Ä‘á»“ng bá»™               |  


---

## 4. ğŸ—‚ï¸ Thiáº¿t káº¿ dá»¯ liá»‡u chÃ­nh



---

## 5. ğŸ› ï¸ Triá»ƒn khai service

### **Cáº¥u trÃºc thÆ° má»¥c**
```
services/
â”œâ”€â”€ user-service/
â”‚ â”œâ”€â”€ app/
â”‚ â”‚ â”œâ”€â”€ core/ # Chá»©a cÃ¡c file cÃ i Ä‘áº·t
â”‚ â”‚ â”œâ”€â”€ api/ # Xá»­ lÃ½ route
â”‚ â”‚ â”œâ”€â”€ models.py # MÃ´ hÃ¬nh SQLAlchemy
â”‚ â”‚ â”œâ”€â”€ schemas.py # MÃ´ hÃ¬nh Pydantic
â”‚ â”‚ â””â”€â”€ main.py # á»¨ng dá»¥ng FastAPI 
â”‚ â”œâ”€â”€ migrations/ # Alembic migrations
â”‚ â””â”€â”€ Dockerfile
â”œâ”€â”€ booking-history-service/
â”œâ”€â”€ hotel-service/
â”œâ”€â”€ notification-service/
â”œâ”€â”€ room-availability-service/
â”œâ”€â”€ booking-service/
gateway/
â”œâ”€â”€ nginx.conf # Reverse proxy rules
â””â”€â”€ Dockerfile
deploy/
â”œâ”€â”€ docker-compose.yml # Multi-container setup
â””â”€â”€ .env # Environment variables
```

### **CÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a tá»«ng dá»‹ch vá»¥**
| Service                     | Database |
|-----------------------------|----------|
| `customer service`          | MySQL    |  
| `movie service`             | MySQL    |
| `ticket booking service`    | MySQL    | 
| `seat availability service` | MySQL    | 
| `payment service`           | MySQL    | 
| `notification service`      | MySQL    |


---

## 6. ğŸ“¦ Deployment vá»›i Docker

### **Quy trÃ¬nh triá»ƒn khai**
1. **Build images**:
   ```bash
   docker-compose build
   ```
2. **Khá»Ÿi Ä‘á»™ng há»‡ thá»‘ng**:
   ```bash
   docker-compose up -d
   ```
3. **Kiá»ƒm tra tráº¡ng thÃ¡i**:
   ```bash
   docker-compose ps
   ```
4. **(Optional) Scale service**:
   ```bash
   docker-compose up -d --scale user-service=3
   ```

---



## 7. Æ¯u Ä‘iá»ƒm kiáº¿n trÃºc

**Æ¯u Ä‘iá»ƒm:**
- **Dá»… má»Ÿ rá»™ng**: Scale riÃªng tá»«ng service (vd: Notification Service khi cÃ³ khuyáº¿n mÃ£i)
- **Äá»™ tin cáº­y**: Lá»—i 1 service khÃ´ng áº£nh hÆ°á»Ÿng toÃ n há»‡ thá»‘ng
- **Báº£o trÃ¬ dá»…**: Chuáº©n hÃ³a trÃªn FastAPI, database tÃ¡ch biá»‡t

**NhÆ°á»£c Ä‘iá»ƒm:**
- **Phá»©c táº¡p váº­n hÃ nh**: Quáº£n lÃ½ nhiá»u DB (PostgreSQL, Redis, MongoDB, RabbitMQ)
- **KhÃ³ Ä‘á»“ng bá»™**: Giao dá»‹ch xuyÃªn service cáº§n Saga Pattern
- **GiÃ¡m sÃ¡t phá»©c táº¡p**: Cáº§n tool theo dÃµi request qua nhiá»u service
- **Chi phÃ­ network**: Giao tiáº¿p liÃªn service tÄƒng overhead

**PhÃ¹ há»£p khi:**
- Cáº§n scale theo tá»«ng tÃ­nh nÄƒng
- Team cÃ³ kinh nghiá»‡m DevOps
- Æ¯u tiÃªn kháº£ nÄƒng chá»‹u táº£i cao
